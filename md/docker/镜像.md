## 镜像
* docker镜像
    * 搜索镜像:`docker search IMAGE_NAME`:`IMAGE_NAME`表示镜像名称
    * 拉取镜像:`docker pull IMAGE_NAME[:TAG]`:`IMAGE_NAME`表示镜像名称,`TAG`表示镜像标签。省略`:TAG`时使用`latest`作为标签
    * 已安装镜像
        * `docker images`:已安装镜像列表(截取参数长度,如:ID截取前12位) 
        * `docker images --no-trunc`:已安装镜像列表(不截取参数长度)  
    * 删除镜像(删除镜像前应该先删除基于此镜像启动的容器)
        * `docker rmi [-f] IMAGE_NAME[:TAG]`:删除镜像
            * `IMAGE_NAME`:镜像名称 
            * `TAG`:镜像标签。省略此标签默认使用`latest`作为标签名  
            * `-f`:强制删除
    * 为已经存在的镜像添加新的镜像名和标签`docker tag OLD_IMAGE NEW_IMAGE`
        * `OLD_IMAGE`:原镜像的ID或"原镜像名:标签"的形式 
        * `NEW_IMAGE`:新镜像名:标签 
    * 从容器打包镜像
        * `docker commit [OPTIONS] CONTAINER_ID IMAGE_NAME[:TAG]`
            * `OPTIONS`
                * `-a`:作者
                * `-m`:备注
            * `CONTAINER_ID`:容器ID
            * `IMAGE_NAME`:将要保存的镜像名称
            * `TAG`:将要保存的镜像标签。省略此标签默认使用`latest`作为标签名  
    * 从镜像打包镜像
        * `docker build -t IMAGE_NAME:TAG DOCKERFILE_DIR`
            * `IMAGE_NAME`:新的镜像名称
            * `TAG`:新的镜像标签
            * `DOCKERFILE_DIR`:`Dockerfile`文件所在的文件夹,此文件夹内必须存在`Dockerfile`文件,`Dockerfile`用法如下:
                * 语法(除`FROM`指令外,其余指令均为可选指令)
                    * `FROM image_name[:tag]`
                        * 含义:来源镜像
                        * `image_name`:原镜像名
                        * `tag`:原镜像的标签。省略则默认为"latest"
                    * `MAINTAINER info`
                        * 含义:维护者信息
                        * `info`:维护者信息,多个信息使用空格分隔 
                    * `RUN {command|<["executable", "param",...]>}`
                        * 含义:构建新镜像前需要在旧镜像中执行的命令,执行结果将固化在新的镜像中
                        * 建议:此指令可以多次执行,但是为了减小构建后的镜像体积,建议将多个命令使用`&&`连接
                        * `command`:通过`/bin/sh -c command`执行此命令
                        * `executable`:直接执行命令
                        * `param`:`executable`命令的参数
                        * `...`:多个参数与`param`类似依次排列
                    * `ENTRYPOINT {command|<["executable", "param",...]>}`
                        * 含义:基于此镜像创建的容器启动时执行的命令
                        * 优先级:最高,创建镜像时指定的主线程命令仅低于的此指令所指定的命令。
                        * 注意:如果使用了`ENTRYPOINT`指令的`["executable", "param",...]`形式,并且使用了`CMD ["param0", "param",...]`形式的指令,则`CMD`中的`["param0", "param",...]`中的所有元素会自动填充到`ENTRYPOINT ["executable", "param",...]`中的`...`
                        * `CMD`与`ENTRYPOINT`的关系
                            <image style="width:100%" src="../img/dockerfile_cmd_entrypoint.png"/>
                        * `command`:通过`/bin/sh -c command`执行此命令
                        * `executable`:直接执行命令
                        * `param`:`executable`命令的参数
                        * `...`:多个参数与`param`类似依次排列
                    * `CMD {command|<["param0", "param",...]>}`
                        * 含义:基于此镜像创建的容器启动时执行的默认命令
                        * 优先级:优先级低于创建镜像时指定的主线程命令。如果没有使用`ENTRYPOINT`指令,且用户指定了主线程命令,则此指令所指定的命令将不会执行
                        * 注意:见`ENTRYPOINT`
                        * `CMD`与`ENTRYPOINT`的关系:见`ENTRYPOINT`
                        * `command`:通过`/bin/sh -c command`执行此命令
                        * `param0`:直接执行此命令 
                        * `param`:`param0`命令的参数 
                        * `...`:多个参数与`param`类似依次排列 
                    * `ENV key value`
                        * 含义:环境变量,定义后可在`RUN`指令中使用,并且在容器运行时保持
                        * `key`:环境变量名称
                        * `value`:环境变量的值 
                        * 例:
                            * 添加环境变量`ENV LANG C.UTF-8`以支持输入输出中文(以及全球语言) 
                    * `EXPOSE ports` 
                        * 含义:容器暴露的端口,用于创建容器时指定随机映射的端口 
                        * `ports`:端口,需要暴露的端口,多个端口可使用空格隔开
                    * `ADD src dest`
                        * 含义:将文件从`src`复制到容器中的`dest`中
                        * `src`:源文件,它可以是以下的路径
                            * `Dockerfile`文件目录所在的的相对路径
                            * 文件`URL`路径
                            * `.tar`格式的压缩文件(将会被自动解压成文件夹)
                        * `dest`:容器的目录文件夹
                    * `ADD src dest`
                        * 含义:将文件从`src`复制到容器中的`dest`中 
                        * `src`:源文件,它可以是以下的路径
                            * `Dockerfile`文件目录所在的的相对路径 
                        * `dest`:容器的目录文件夹
                    * `VOLUME [PATH1,PATH2,...]`
                        * 含义:容器挂载点,不可指定宿主机目录。可在创建容器后通过`docker inspect CONTAINER_ID`查看`Mounts`得知容器的挂载目录
                        * `PATH1`,`PATH2`:容器的目录,多个挂载目录添加到数组中即可 
                    * `USER username_uid`
                        * 含义:指定容器运行时的用户。指定后,后续的`RUN`指令也会使用此用户执行命令 
                        * `username_uid`:用户名或用户`UID`
                    * `WORKDIR path`
                        * 含义:为后续的`RUN`,`CMD`,`ENTRYPOINT`指令指定工作目录 
                        * `path`:工作目录。如果使用的是相对路径,则是相对于前一个工作目录 
                    * `ONBUILD instruction`
                        * 含义:除`FROM`和`ONBUILD`指令外,在以上的指令前添加此命令构建镜像,对此次构建镜像没有影响,但是如果以此镜像的构建结果再构建其他的镜像时,含有`ONBUILD`指令的命令也会被自动执行 
                        * `instruction`::除`FROM`和`ONBUILD`指令外的其他`Dockerfile`指令 
                * 示例
                    ```shell
                    #为镜像添加cron服务 
                    FROM ubuntu
                    RUN apt update && apt install cron
                    ```
    * 镜像保存为文件、从文件加载为镜像
        * 保存为文件`docker save -o PATH IMAGES`
            * `PATH`:保存镜像文件的路径
            * `IMAGES`:`镜像名称[:镜像标签]`,多个镜像之间使用空格分隔 
        * 从文件加载镜像`docker load -i PATH`
            * `PATH`:打包好的镜像文件的路径 